[gd_scene load_steps=30 format=3 uid="uid://djwirk4ockuor"]

[ext_resource type="Script" uid="uid://puedae26ukqg" path="res://scenes/hideout/hideout.gd" id="1_ura2u"]
[ext_resource type="PackedScene" uid="uid://d1lcmhjvkefw6" path="res://assets/garage/garage.tscn" id="2_7v8ca"]
[ext_resource type="Shader" uid="uid://bafs2pth5iv6y" path="res://scenes/hideout/viewport-buffer.tres" id="2_eegbv"]
[ext_resource type="Script" uid="uid://pkwdcfxgso1q" path="res://cinna_cam/camera_movement/cinna_cam.gd" id="3_ura2u"]
[ext_resource type="Script" uid="uid://bf4wol320c205" path="res://cinna_cam/camera_movement/planar-system.gd" id="4_eegbv"]
[ext_resource type="PackedScene" uid="uid://bohb81o14ve6l" path="res://assets/arcade-cabinet/arcade-cabinet.tscn" id="5_60i1o"]
[ext_resource type="Script" uid="uid://cep4n5ilt5opf" path="res://cinna_cam/camera_movement/angular-system.gd" id="5_x1t0x"]
[ext_resource type="Script" uid="uid://c3pfswfcml75e" path="res://cinna_cam/pathing/meta-path.gd" id="7_embkr"]
[ext_resource type="Script" uid="uid://u8kmj6bobusb" path="res://cinna_cam/pathing/path-section.gd" id="8_seky7"]
[ext_resource type="PackedScene" uid="uid://xnag74oihr5b" path="res://assets/camera/test_cam.tscn" id="9_60i1o"]
[ext_resource type="PackedScene" uid="uid://sj3wt5u1le7l" path="res://scenes/temple/temple.tscn" id="11_ura2u"]
[ext_resource type="Script" uid="uid://2j378cfp4am" path="res://scenes/hideout/fps_counter.gd" id="13_x1t0x"]
[ext_resource type="PackedScene" uid="uid://c3qs16gcm7owy" path="res://assets/bike/bike.tscn" id="16_seky7"]

[sub_resource type="ViewportTexture" id="ViewportTexture_60i1o"]
viewport_path = NodePath("ArcadeCabinet/CanvasLayer/SubViewportContainer/AuxCam")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_ura2u"]
resource_local_to_scene = true
shader = ExtResource("2_eegbv")
shader_parameter/Texture2DParameter = SubResource("ViewportTexture_60i1o")

[sub_resource type="ViewportTexture" id="ViewportTexture_embkr"]
viewport_path = NodePath("ArcadeCabinet/CanvasLayer2/SubViewportContainer/AuxCam2")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_seky7"]
resource_local_to_scene = true
shader = ExtResource("2_eegbv")
shader_parameter/Texture2DParameter = SubResource("ViewportTexture_embkr")

[sub_resource type="ViewportTexture" id="ViewportTexture_eegbv"]
viewport_path = NodePath("RenderBuffer")

[sub_resource type="ViewportTexture" id="ViewportTexture_seky7"]
viewport_path = NodePath("RenderBuffer2")

[sub_resource type="Resource" id="Resource_leb7k"]
script = ExtResource("4_eegbv")
metadata/_custom_type_script = "uid://dygsmwmd0om4g"

[sub_resource type="Resource" id="Resource_au00d"]
script = ExtResource("5_x1t0x")
f = 0.5
z = 1.0
r = 0.9
metadata/_custom_type_script = "uid://bi740sq5wwli2"

[sub_resource type="Resource" id="Resource_xbpu6"]
script = ExtResource("5_x1t0x")
f = 0.5
z = 1.23
r = 1.0
metadata/_custom_type_script = "uid://bi740sq5wwli2"

[sub_resource type="Curve3D" id="Curve3D_31ftd"]

[sub_resource type="Curve3D" id="Curve3D_8borv"]

[sub_resource type="Curve3D" id="Curve3D_ql7g8"]
_data = {
"points": PackedVector3Array(-0.018894, -0.0092901, -0.303669, 0.018894, 0.0092901, 0.303669, 0, 0, 0, -0.137801, 0.104957, -0.0607364, 0.137801, -0.104957, 0.0607364, 0.30401, -1.12525, 0.795865, -0.47103, 0.0288217, 0.00987315, 0.47103, -0.0288217, -0.00987315, 1.29333, -1.31543, 0.963719),
"tilts": PackedFloat32Array(0, 0, 0)
}
point_count = 3

[sub_resource type="Curve3D" id="Curve3D_esgtm"]
_data = {
"points": PackedVector3Array(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3.76435, 0.000717998, 5.00679e-05),
"tilts": PackedFloat32Array(0, 0)
}
point_count = 2

[sub_resource type="Curve3D" id="Curve3D_psd4u"]
_data = {
"points": PackedVector3Array(-1.44796, 0.0132656, 0.0890958, 1.44796, -0.0132656, -0.0890958, 0, 0, 0, -0.0893455, -0.00735193, 0.474401, 0.0893455, 0.00735193, -0.474401, 1.66376, 0, -1.24446, 0.396737, -2.75075e-05, 0.467067, -0.396737, 2.75075e-05, -0.467067, 1.12786, 0, -3.29451, 0.317598, -0.0812988, 0.16255, -0.317598, 0.0812988, -0.16255, 0.24161, 0.004549, -3.71045),
"tilts": PackedFloat32Array(0, 0, 0, 0)
}
point_count = 4

[sub_resource type="Curve3D" id="Curve3D_leb7k"]
_data = {
"points": PackedVector3Array(0.431524, -0.115467, 0.155382, -0.431524, 0.115467, -0.155382, 0, 0, 0, 0.93592, -0.0111766, 0, -0.93592, 0.0111766, 0, -1.63232, 1.17636, -0.370494, 1.20917, 0, -1.0193, -1.20917, 0, 1.0193, -4.18894, 1.1798, 0.482654, 0.00500298, -0.070666, -0.604535, -0.00500298, 0.070666, 0.604535, -5.29929, 1.31016, 2.74668),
"tilts": PackedFloat32Array(0, 0, 0, 0)
}
point_count = 4

[sub_resource type="Curve3D" id="Curve3D_au00d"]

[node name="Hideout" type="Node3D" node_paths=PackedStringArray("cinna_cam")]
script = ExtResource("1_ura2u")
cinna_cam = NodePath("CameraController")

[node name="RenderBuffer" type="SubViewport" parent="."]
size = Vector2i(360, 360)
render_target_clear_mode = 2
render_target_update_mode = 4

[node name="ColorRect" type="ColorRect" parent="RenderBuffer"]
material = SubResource("ShaderMaterial_ura2u")
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0, 0, 0, 1)

[node name="RenderBuffer2" type="SubViewport" parent="."]
size = Vector2i(360, 360)

[node name="ColorRect" type="ColorRect" parent="RenderBuffer2"]
material = SubResource("ShaderMaterial_seky7")
offset_right = 360.0
offset_bottom = 360.0

[node name="Garage" parent="." instance=ExtResource("2_7v8ca")]

[node name="Bike" parent="." instance=ExtResource("16_seky7")]
transform = Transform3D(-0.997038, 0, 0.0769104, 0, 1, 0, -0.0769104, 0, -0.997038, -1.855, 0, 1.03464)

[node name="ArcadeCabinet" parent="." instance=ExtResource("5_60i1o")]
transform = Transform3D(0.66523, 0, -0.746638, 0, 1, 0, 0.746638, 0, 0.66523, -3.49869, 0.00211923, -1.93705)

[node name="Sprite3D" type="Sprite3D" parent="ArcadeCabinet"]
transform = Transform3D(0.975554, -0.219761, 0, 0.219761, 0.975554, 0, 2.98023e-08, -7.45058e-09, 1, 0.219969, 1.8439, 0.224828)
pixel_size = 0.0013
axis = 0
texture = SubResource("ViewportTexture_eegbv")

[node name="CanvasLayer" type="CanvasLayer" parent="ArcadeCabinet"]
follow_viewport_enabled = true
follow_viewport_scale = 7.905

[node name="SubViewportContainer" type="SubViewportContainer" parent="ArcadeCabinet/CanvasLayer"]
offset_right = 360.0
offset_bottom = 360.0

[node name="AuxCam" type="SubViewport" parent="ArcadeCabinet/CanvasLayer/SubViewportContainer"]
handle_input_locally = false
size = Vector2i(360, 360)
render_target_update_mode = 4

[node name="TestCam" parent="ArcadeCabinet/CanvasLayer/SubViewportContainer/AuxCam" instance=ExtResource("9_60i1o")]
transform = Transform3D(0.8497257, 0.1476236, 0.5061358, 0, 0.9599997, -0.28000113, -0.527225, 0.23792416, 0.8157364, 61.588913, 1.9759982, -67.86676)

[node name="Sprite3D2" type="Sprite3D" parent="ArcadeCabinet"]
transform = Transform3D(0.975554, -0.219761, 0, 0.219761, 0.975554, 0, 2.98023e-08, -7.45058e-09, 1, 0.219968, 1.8439, -0.233517)
pixel_size = 0.0013
axis = 0
texture = SubResource("ViewportTexture_seky7")

[node name="CanvasLayer2" type="CanvasLayer" parent="ArcadeCabinet"]
follow_viewport_enabled = true
follow_viewport_scale = 7.905

[node name="SubViewportContainer" type="SubViewportContainer" parent="ArcadeCabinet/CanvasLayer2"]
offset_left = 360.0
offset_right = 720.0
offset_bottom = 360.0

[node name="AuxCam2" type="SubViewport" parent="ArcadeCabinet/CanvasLayer2/SubViewportContainer"]
handle_input_locally = false
size = Vector2i(360, 360)
render_target_update_mode = 4

[node name="Camera3D" type="Camera3D" parent="ArcadeCabinet/CanvasLayer2/SubViewportContainer/AuxCam2"]
transform = Transform3D(0.529993, -0.39096, 0.752501, 0, 0.887381, 0.461036, -0.848002, -0.244346, 0.470306, 71.0699, 8.33833, -47.9196)

[node name="CameraController" type="Node3D" parent="." node_paths=PackedStringArray("camera", "meta_paths")]
script = ExtResource("3_ura2u")
camera = NodePath("TestCam")
meta_paths = [NodePath("Loiter"), NodePath("ArcadeCabinet"), NodePath("Bike"), NodePath("Toolbox")]
position_targeter = SubResource("Resource_leb7k")
x_look_targeter = SubResource("Resource_au00d")
y_look_targeter = SubResource("Resource_xbpu6")
metadata/_custom_type_script = "uid://pkwdcfxgso1q"

[node name="TestCam" parent="CameraController" instance=ExtResource("9_60i1o")]
transform = Transform3D(0.934135, -0.097613774, -0.34331223, 0, 0.961875, -0.2734894, 0.3569198, 0.25547603, 0.8985211, 2.331034, 0.34280205, -0.92988485)
near = 0.005
far = 100.0

[node name="Bike" type="Node3D" parent="CameraController"]
script = ExtResource("7_embkr")
metadata/_custom_type_script = "uid://c3pfswfcml75e"

[node name="PathSection" type="Path3D" parent="CameraController/Bike"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.12016, 0.658085, -0.484418)
curve = SubResource("Curve3D_31ftd")
script = ExtResource("8_seky7")
tracking_type = 2
angle_target_degrees_x = 127.5
angle_target_degrees_y = 3.0
relative_to_travel_direction = false
treat_as_point = false
metadata/_custom_type_script = "uid://u8kmj6bobusb"

[node name="Toolbox" type="Node3D" parent="CameraController"]
script = ExtResource("7_embkr")
metadata/_custom_type_script = "uid://c3pfswfcml75e"

[node name="PathSection" type="Path3D" parent="CameraController/Toolbox"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 2.94792, 0.808367, -0.571222)
curve = SubResource("Curve3D_8borv")
script = ExtResource("8_seky7")
follow_target_node = NodePath("../ToolboxLookAt")
metadata/_custom_type_script = "uid://u8kmj6bobusb"

[node name="ToolboxLookAt" type="Node3D" parent="CameraController/Toolbox"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 3.07519, 0.869301, -2.50584)

[node name="Loiter" type="Node3D" parent="CameraController"]
script = ExtResource("7_embkr")
auto_start = true
metadata/_custom_type_script = "uid://c3pfswfcml75e"

[node name="PathSection" type="Path3D" parent="CameraController/Loiter"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -3.86565, 1.65758, 1.3795)
curve = SubResource("Curve3D_ql7g8")
script = ExtResource("8_seky7")
speed = 0.5
time_to_finish = 4.97762
follow_target_node = NodePath("../BikeBack")
metadata/_custom_type_script = "uid://u8kmj6bobusb"

[node name="PathSection2" type="Path3D" parent="CameraController/Loiter"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -2.57232, 0.34215, 2.34322)
curve = SubResource("Curve3D_esgtm")
script = ExtResource("8_seky7")
speed = 0.5
time_to_finish = 7.5287
tracking_type = 3
metadata/_custom_type_script = "uid://u8kmj6bobusb"

[node name="PathSection3" type="Path3D" parent="CameraController/Loiter"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.19203, 0.342868, 2.34327)
curve = SubResource("Curve3D_psd4u")
script = ExtResource("8_seky7")
speed = 0.5
time_to_finish = 10.9572115
follow_target_node = NodePath("../../Toolbox/ToolboxLookAt")
metadata/_custom_type_script = "uid://u8kmj6bobusb"

[node name="PathSection4" type="Path3D" parent="CameraController/Loiter"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.43364, 0.347417, -1.36718)
curve = SubResource("Curve3D_leb7k")
script = ExtResource("8_seky7")
speed = 0.5
time_to_finish = 15.130656
follow_target_node = NodePath("../ArcadeCabinetLookAt")
metadata/_custom_type_script = "uid://u8kmj6bobusb"

[node name="BikeBack" type="Node3D" parent="CameraController/Loiter"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -3.70578, 0.58476, 0.95633)

[node name="ArcadeCabinetLookAt" type="Node3D" parent="CameraController/Loiter"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -3.32532, 1.88233, -1.75348)

[node name="ArcadeCabinet" type="Node3D" parent="CameraController"]
script = ExtResource("7_embkr")
metadata/_custom_type_script = "uid://c3pfswfcml75e"

[node name="PathSection" type="Path3D" parent="CameraController/ArcadeCabinet"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -3.10979, 1.943, -1.49678)
curve = SubResource("Curve3D_au00d")
script = ExtResource("8_seky7")
tracking_type = 2
angle_target_degrees_x = 41.6
angle_target_degrees_y = -13.0
relative_to_travel_direction = false
treat_as_point = true
metadata/_custom_type_script = "uid://u8kmj6bobusb"

[node name="Temple" parent="." node_paths=PackedStringArray("camera") instance=ExtResource("11_ura2u")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 51.4022, 0, -61.4187)
camera = NodePath("../ArcadeCabinet/CanvasLayer/SubViewportContainer/AuxCam/TestCam")

[node name="Control" type="Control" parent="."]
layout_mode = 3
anchors_preset = 0
offset_right = 40.0
offset_bottom = 40.0

[node name="CanvasLayer" type="CanvasLayer" parent="Control"]

[node name="FPSCounter" type="Label" parent="Control/CanvasLayer"]
offset_right = 40.0
offset_bottom = 23.0
script = ExtResource("13_x1t0x")

[node name="TouchInput" type="Control" parent="."]
layout_mode = 3
anchors_preset = 0
offset_right = 40.0
offset_bottom = 40.0

[node name="CanvasLayer" type="CanvasLayer" parent="TouchInput"]

[node name="PreviousCamera" type="Button" parent="TouchInput/CanvasLayer"]
anchors_preset = 7
anchor_left = 0.5
anchor_top = 1.0
anchor_right = 0.5
anchor_bottom = 1.0
offset_left = -69.0
offset_top = -161.0
offset_right = -4.0
offset_bottom = -16.0
grow_horizontal = 2
grow_vertical = 0
theme_override_font_sizes/font_size = 100
text = "<"

[node name="NextCamera" type="Button" parent="TouchInput/CanvasLayer"]
anchors_preset = 7
anchor_left = 0.5
anchor_top = 1.0
anchor_right = 0.5
anchor_bottom = 1.0
offset_left = 6.0
offset_top = -161.0
offset_right = 71.0
offset_bottom = -16.0
grow_horizontal = 2
grow_vertical = 0
theme_override_font_sizes/font_size = 100
text = ">"

[connection signal="ready" from="CameraController" to="." method="_on_camera_controller_ready"]
[connection signal="pressed" from="TouchInput/CanvasLayer/PreviousCamera" to="." method="_on_previous_camera_pressed"]
[connection signal="pressed" from="TouchInput/CanvasLayer/NextCamera" to="." method="_on_next_camera_pressed"]
